"use strict";(self.webpackChunkfrontend_template2=self.webpackChunkfrontend_template2||[]).push([[418],{6418:(b,p,i)=>{i.r(p),i.d(p,{LoginLayoutModule:()=>L});var m=i(6895),c=i(7251),s=i(4006),t=i(4650),h=i(8290),d=i(976);function g(e,r){1&e&&t._UZ(0,"i",16)}function f(e,r){1&e&&t._UZ(0,"i",17)}const w=[{path:"login",component:(()=>{class e{constructor(n,o,a,l){this.postService=n,this.auth=o,this.router=a,this.route=l,this.form=new s.cw({username:new s.NI("",[s.kI.minLength(1)]),password:new s.NI("",[s.kI.minLength(1)])}),this.submitted=!1,this.error=!1,this.hide=!0,this.basic="",this.response="",this.return="",this.client_id="s22n-bve315o-13N3vPo44pn-s13N15",this.client_secret="",this.showpassword=!1}ngOnInit(){this.type="password",this.route.queryParams.subscribe(n=>this.return=n.return||"/main"),this.auth.isUserLoggedIn()&&this.router.navigateByUrl(this.return)}showpass(){"password"===this.type?(this.type="text",this.showpassword=!0):(this.type="password",this.showpassword=!1)}onSubmit(){let n=this.form.get("username")?.value||"",o=this.form.get("password")?.value||"";if(!this.submitted){if(this.response="Wellcome back",this.error=!1,!this.form.get("username")?.value&&!this.form.get("password")?.value)return window.alert("Please enter your username and password."),this.form.controls.username.setErrors({invalid:!0}),void this.form.controls.password.setErrors({invalid:!0});if(!this.form.get("username")?.value&&this.form.get("password")?.value)return window.alert("Please enter your username."),void this.form.controls.username.setErrors({invalid:!0});if(this.form.get("username")?.value&&!this.form.get("password")?.value)return window.alert("Please enter your password."),void this.form.controls.password.setErrors({invalid:!0});this.submitted=!0;let a=new URLSearchParams;a.set("client_id",this.client_id);let l=new URLSearchParams;console.log(n.toLowerCase()),this.postService.POST("/dcc/secretID",a,"none").then(u=>{this.client_secret=String(u)}).then(()=>{l.set("username",n.toLowerCase()),l.set("password",o),l.set("client_id",this.client_id),l.set("client_secret",this.client_secret),this.postService.POST("/auth/auth",l,"none").then(u=>{this.basic=String(u)}).catch(()=>{window.alert("Username or Password is incorrect")}).then(()=>{this.auth.isAuthenticated(n,o,this.client_id,this.client_secret).then(()=>{this.router.navigateByUrl("/main")}).catch(u=>{console.log(u)})})}).catch(u=>{console.log(u),window.alert("Fail to login")}).finally(()=>{this.submitted=!1})}}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(h.L),t.Y36(d.$),t.Y36(c.F0),t.Y36(c.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-login"]],decls:18,vars:4,consts:[[1,"loginBody"],[1,"text-center","container-fluid"],[1,"form-signin","w-100","mx-auto"],[3,"formGroup"],["src","../../assets/dptf.png","alt","","width","50%","height","50%",1,"mb-4"],[1,"h3","mb-3","fw-normal",2,"color","rgb(255, 255, 255)"],[1,"input-group","mb-3",2,"height","50px"],["type","text","placeholder","Username","autocomplete","nope","formControlName","username",1,"form-control",3,"keydown.Enter"],[1,"input-group-text"],[1,"bi","bi-person-fill"],[1,"input-group","mb-3"],["placeholder","Password","id","pass","formControlName","password",1,"form-control",2,"height","50px",3,"type","keydown.Enter"],[1,"input-group-text",2,"height","50px",3,"click"],["class","bi bi-eye-slash-fill",4,"ngIf"],["class","bi bi-eye-fill",4,"ngIf"],["type","submit","role","button",1,"w-100","btn","btn-lg","btn-primary",3,"click"],[1,"bi","bi-eye-slash-fill"],[1,"bi","bi-eye-fill"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"main",2)(3,"form",3),t._UZ(4,"img",4),t.TgZ(5,"h1",5),t._uU(6,"Safety & Security Department"),t.qZA(),t.TgZ(7,"div",6)(8,"input",7),t.NdJ("keydown.Enter",function(){return o.onSubmit()}),t.qZA(),t.TgZ(9,"span",8),t._UZ(10,"i",9),t.qZA()(),t.TgZ(11,"div",10)(12,"input",11),t.NdJ("keydown.Enter",function(){return o.onSubmit()}),t.qZA(),t.TgZ(13,"span",12),t.NdJ("click",function(){return o.showpass()}),t.YNc(14,g,1,0,"i",13),t.YNc(15,f,1,0,"i",14),t.qZA()(),t.TgZ(16,"a",15),t.NdJ("click",function(){return o.onSubmit()}),t._uU(17,"Log in"),t.qZA()()()()()),2&n&&(t.xp6(3),t.Q6J("formGroup",o.form),t.xp6(9),t.Q6J("type",o.type),t.xp6(2),t.Q6J("ngIf",1==o.showpassword),t.xp6(1),t.Q6J("ngIf",0==o.showpassword))},dependencies:[m.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u],styles:["html[_ngcontent-%COMP%], .loginBody[_ngcontent-%COMP%]{display:flex;align-items:center;background:-webkit-repeating-radial-gradient(#f00404,#000000);position:absolute;height:100%;width:100%}input[_ngcontent-%COMP%]::-ms-reveal, input[_ngcontent-%COMP%]::-ms-clear{display:none}.form-signin[_ngcontent-%COMP%]{max-width:330px;padding:15px}.form-signin[_ngcontent-%COMP%]   .form-floating[_ngcontent-%COMP%]:focus-within{z-index:2}"]}),e})()}];let y=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[c.Bz.forChild(w),c.Bz]}),e})(),L=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[m.ez,y]}),e})()}}]);